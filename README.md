# TAU Vehicle

Решение соревнования ["TAU Vehicle Type Recognition Competition"](https://www.kaggle.com/competitions/vehicle/overview) на платформе Kaggle.

[![Python Version](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/)
[![Poetry Version](https://img.shields.io/badge/poetry-1.5+-orange.svg)](https://python-poetry.org/)

## Постановка задачи

Задача заключается в классификации транспортных средств на изображениях по 17 классам. Проект основан на соревновании Kaggle. 

### Формат данных
- **Входные данные:** 36 тысяч изображений сцен, содержащих транспортные средства, разделенные на тренировочную и тестовую выборки.
- **Выходные данные:** Для каждого изображения из тестовой выборки необходимо определить номер класса (от 0 до 16). Результаты должны быть сохранены в CSV-файле.

### Метрики
Основная метрика — **Accuracy**

**Целевые показатели:**  
Accuracy ≥ 0.9 на тестовой выборке.

## Setup

1. Склонируйте репозиторий
```bash
git clone https://github.com/KIrillPal/tau-vehicle-classification.git
cd tau-vehicle-classification
```
2. Установите зависимости через poetry
```bash
poetry install
```
3. Установка и запуск pre-commit hooks
```bash
pre-commit install
pre-commit run -a
```

## Train
Скрипт для тренировки реализован через @hydra.main. Конфиги для тренировки лежат в директории [conf](conf).
Для запуска бейзлайна выполните команду из корня репозитория:
```bash
poetry run python3 -m tau_vehicle.src.train
```

Особенности тренировки:
- Данные для тренировки подгружаются через DVC из поднятого хранилища S3: http://109.248.163.128:9000
- Логирование организовано через собственный MLFlow: http://109.248.163.128:5000/#/experiments/621882993446461474
- Вся конфигурация, включая выбор оптимизатора и шедлера, выполнена через Hydra
- Реализован класс HuggingFaceModel, подгружающий модели с HuggingFace
- Всё обучение организовано через PyTorch Lightning
- Обучение нельзя начать, если в репозитории есть незакоммиченные изменения.
  Поскольку MLFlow логирует коммит, всё должно быть зафиксировано для воспроизводимости.
- Скрипт просит явно ввести имя и описание эксперимента, поскольку на практике выяснено, что такая организация помогает не забыть внести актуальное описание эксперимента.
- Локально веса сохраняются в <папка с экспериментами>/<имя эксперимента>/<имя запуска>. Все имена конфигурируются.